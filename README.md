# PhoneBook

Test task in DINS (Intern Java Developer (Collaboration Tool))

## Условие

Тестовое задание

1. Написать программу, удовлетворяющую указанным требованиям.

2. Написать юнит тесты на написанный код.

3. Должны быть использованы следующие технологии: Java (8 версии или выше), Spring Boot, JUnit.

4. Должны быть предоставлены: исходный код программы, юнит тесты, инструкция по запуску программы.

5. Стоит уделить особое внимание REST спецификации и организации REST методов.

Требования к программе:

Нужно написать серверную часть приложения (без UI части) по работе с пользователями и их телефонной книжкой.

Программа должна предоставлять REST API для:

* получения списка всех пользователей (владельцев телефонных книжек)

* создания, получения (по id), удаления, редактирования пользователя

* создания, получения (по id), удаления, редактирования записи в телефонной книжке

* получения списка всех записей в телефонной книжке пользователя

* поиск пользователей по имени (или его части)*, поиск телефонной записи по номеру телефона

## Как запустить

Запускается согласно инструкции, которая есть в документации к Spring Boot (`./mvnw clean spring-boot:run` или `mvn clean spring-boot:run`). Помимо этого, приложение загружено на Heroku и доступно по ссылке: https://myphonebookappp.herokuapp.com/data/users.

## Как пользоваться

После запуска приложения, можно использовать следующие команды:

- `curl -v localhost:8080/data/users` - получение списка пользователей (владельцев телефонных книжек).
- `curl -v localhost:8080/data/users/0` - получение пользователя с id=0.
- `curl -X POST -H "Content-Type:application/json" -H "Cache-Control:no-cache" localhost:8080/data/users -d "{\"name\":\"add\", \"surname\":\"test\", \"phone\":\"88123281934\"}"` - создание нового пользователя с именем "add", фамилией "test" и номером телефона "88123281934".
- `curl -X DELETE localhost:8080/data/users/0` - удаление пользователя с id=0.
- `curl -X PUT localhost:8080/data/users/1 -H "Content-type:application/json" -d "{\"name\":\"Samwise\", \"surname\":\"Gamgee\"}"` - изменение у пользователя с id=0 имени на "Samwise" и фамилии на "Gamgee", остальные данные остаются неизменными.
- `curl -v localhost:8080/data/users/0/1` - получение у пользователя с id=0 записи в телефонной книжке - человека с id=1.
- `curl -X POST -H "Content-Type:application/json" -H "Cache-Control:no-cache" localhost:8080/data/users/1 -d "{\"name\":\"add\", \"surname\":\"test\", \"phone\":\"881232819345\"}"` - добавление новой записи в телефонную книжку пользователю с id=1, у которой имя "add", фамилия "test" и номер телефона "88123281934".
- `curl -X DELETE localhost:8080/data/users/1/0` - удаление записи в телефонной книжке - человека с id=0 у пользователя с id=1.
- `curl -X PUT localhost:8080/data/users/1/0 -H "Content-type:application/json" -d "{\"name\":\"Samwise\", \"surname\":\"Gamgee\"}"` - изменение записи в телефонной книжке - человека с id=0 у пользователя с id=1. Имя меняется на "Samwise", фамилия - на "Gamgee", остальные данные остаются неизменными.
- `curl -v localhost:8080/data/users/0/phonebook` - получение телефонной книжки у пользователя с id=0.
- `curl -v localhost:8080/data/users/find/name/iva` - получение пользователей, имя которых содержит "iva" (регистр не учитывается).
- `curl -v localhost:8080/data/users/find/phone/880` - получение пользователей, телефонный номер которых содержит "880".
- `curl -v localhost:8080/data/users/0/find/name/iva` - получение пользователей, имя которых содержит "iva" (регистр не учитывается) в телефонной книжке у пользователя с id=0.
- `curl -v localhost:8080/data/users/0/find/phone/880` - получение пользователей, телефонный номер которых содержит "880" в телефонной книжке у пользователя с id=0.

## Немного о приложении

Если при получении пользователя указать неверный id (несуществующий), то выдаст следующее сообщение для `curl -v localhost:8080/data/users/3`: Couldn't find user with id = 3.

При добавлении пользователя и изменении данных проверяются поля name, surname и phone с помощью регулярных выражений. Так, name и surname должны содержать в себе только буквы и знак тире (для пользователей с двойными именами/фамилиями). Номер телефона должен начинаться на "8" и содержать после этого 10 цифр (стандартный российский номер). Если же неправильно ввести данные, например, при добавлении пользователя с номером "881232819b34", выдаст следующее сообщение: Phone number must start with "8" and contain 10 digits after it. Wrong number: 881232819b34. Помимо этого, нельзя добавить пользователя, если такой уже существует (проверяются поля name, surname, phone). Нельзя добавить пользователя с отрицательным id. Нельзя добавить пользователя с id, который уже встречается в данных. Если, например, попытаться добавить пользователя с userId=-3, программа выведет: You cannot add a user with a negative id = -3. Если, например, попытаться добавить пользователя с userId=0 (который уже существует), программа выдаст: User with id = 0 already exists. Если, к примеру, попытаться добавить пользователя с одинаковыми данным 2 раза, программа выведет: User{id='null', name='add', surname='test', phone='88123281934'} already exists.

При удалении данных проверяется, есть ли пользователь с заданным id в данных.
